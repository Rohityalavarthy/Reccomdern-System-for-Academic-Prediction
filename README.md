The complete code is at 

https://drive.google.com/drive/folders/12nZZFVutgRj-LnWKIY74BJfmKO9fQd7B?usp=sharing
